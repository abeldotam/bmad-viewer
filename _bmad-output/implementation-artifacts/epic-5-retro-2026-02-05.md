# Epic 5 Retrospective: Détail story

Date: 2026-02-05

## Epic Summary

- **Stories delivered:** 2/2 (100%)
- **Stories:** 5.1 Contenu Markdown & métadonnées, 5.2 PRs associées & issues liées
- **FRs couverts:** FR24, FR25, FR26, FR27

## What Went Well

- **Layout deux colonnes:** Le contenu Markdown à gauche et les métadonnées à droite donnent une vue complète sans scroll excessif. Le layout est responsive (stack vertical sur mobile).
- **Lazy-loading du contenu:** Le Markdown de la story est chargé à la demande (`fetchFileContent`) — pas de surcharge au préchargement initial du repo.
- **StoryMetadata structuré:** Card sidebar avec epic, statut, priorité, estimation, assignee. Les informations sont denses mais lisibles grâce aux badges et icônes.
- **RelatedPRs fonctionnel:** Le composant affiche les PRs liées à l'epic de la story avec badge d'état (open/merged/closed/draft) et lien GitHub. Caché quand il n'y a pas de PR — layout propre.
- **Breadcrumb contextuel:** Le fil d'Ariane permet de remonter vers la liste des epics depuis le détail story.

## What Could Be Improved

- **RelatedPRs au niveau epic, pas story:** Les PRs sont matchées par sprint/epic, pas par story individuelle. Une story dans un epic avec PR verra la PR de l'epic, même si la PR ne concerne pas cette story spécifiquement. C'est une limitation du modèle de données BMAD.
- **LinkedIssues limité:** Le composant affiche les issues GitHub liées mais dépend d'un appel API séparé. Pas de cache client — re-fetch à chaque visite.
- **Pas de "copy link" pour partager une story:** L'URL est stable (`/repos/:owner/:repo/story/:id`) mais il n'y a pas de bouton pour copier le lien.

## Key Insights

- Le pattern provide/inject via `useRepoData` permet d'accéder aux stories et sprints sans props drilling depuis la page story — le composable est injectable à n'importe quel niveau de l'arbre.
- La relation PR → story passe par le sprint parent : `sprints.find(s => s.stories.some(st => st.id === story.id))?.pr`. C'est indirect mais reflète la réalité BMAD (PRs par epic, pas par story).

## Action Items

1. **Cache client LinkedIssues** — stocker les issues déjà chargées dans un Map réactif
2. **Bouton "copy link"** — ajouter un bouton copie-URL dans StoryHeader
3. **Mapping PR par story** (v2) — si le format BMAD évolue pour supporter des branches par story, adapter le mapping

## Readiness Assessment

- [x] Tous les AC satisfaits
- [x] Contenu Markdown rendu < 500ms
- [x] Métadonnées complètes en sidebar
- [x] PRs associées avec badges d'état et liens GitHub
- [x] Issues liées affichées
- [x] Story not found → message explicite
