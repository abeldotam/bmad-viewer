# Story 6.1: Commentaire sur story → issue GitHub

Status: done

## Story

As a **user viewing a story**,
I want **to submit a comment that creates a GitHub issue with full story context and automatic BMAD labels**,
So that **I can report corrections or feedback without leaving the app**.

## Acceptance Criteria

1. Given I type a comment and submit, Then a GitHub issue is created in < 5s with title `[BMAD Comment] Story {id}: {excerpt}` (AC:1)
2. Given an issue is created, Then labels `bmad-comment`, `story: {id}`, `epic: {epicId}` are applied (AC:2)
3. Given creation fails, Then I see an error and my comment text is preserved (AC:3)
4. Given success, Then I see a toast with a link to the created issue (AC:4)

## Tasks / Subtasks

- [x] Create CommentForm.vue — UTextarea + submit button
- [x] Create useGitHubIssues.ts — createComment() with label generation
- [x] Create POST /api/github/issues — issue creation via Octokit
- [x] Issue body generation with story context (via issueTemplates.ts)

## Dev Notes

### Implementation: COMPLETE

- CommentForm uses MarkdownEditor (write/preview toggle) with loading state on submit, button disabled during submission to prevent duplicates
- Markdown preview via MDC component with prose styling
- Labels generated by getCommentLabels() helper
- Issue body built by buildCommentIssueBody() in issueTemplates.ts
- Server validates auth + repo ownership before creating issue

### File List

- `app/components/story/CommentForm.vue`
- `app/components/MarkdownEditor.vue`
- `app/composables/useGitHubIssues.ts`
- `server/api/github/issues.post.ts`
- `app/utils/issueTemplates.ts`
